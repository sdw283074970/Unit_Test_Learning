# 模拟框架 Mock Framework
本篇记录了一个模拟框架`Moq`的使用方法

### 什么是模拟框架?
简单的讲，模拟框架是一个模拟`测试替身`输入和输出的框架。主要目的位使用同一个`测试替身`模拟出不同的执行路径。

以之前的测试例子为例，测试替身`FakeFileReader`类返回一个空的字符串。等于说，只能模拟当返回字符串位空时，`ReadVideoTitle()`方法中的一个执行路径，即检测反序列化失败时是否能正确的返回错误信息。在没有模拟框架的情况下，如果想模拟反序列化成功的执行路径，就需要再写一个`测试替身`，这会让整个测试项目变得臃肿不堪。

于是模拟框架`Mock Framework`应运而生。它可以帮助测试人员动态的生成`测试替身`，我们能通过编程让这些`测试替身`执行各种我们需要的行为，如返回值或触发事件。

与依赖注入框架一样，模拟框架也有很多款可供选择。如`Moq`、`NSubstitute`、`FakeItEasy`、`Rhino Mocks`等。这里推荐使用`Moq`框架。

### 如何安装模拟框架?
在VS中打开`Package Manager`，选择测试项目，输入`install-package Moq -Version:4.7.142`就安装指定版本的`Moq`框架。

### 如何使用`Moq`框架?
有了模拟框架后，就不需要手动创建`测试替身`了。在之前的例子中，删除`FakeFileReader`类。取而代之的，只用在测试代码中`Arrange`部分动态的创建`测试替身`并使用即可。在测试方法中创建`测试替身`代码如下:
```c#
            var fileReader = new Mock<IFileReader>();
```
以上代码意思位，创建一个执行了`IFileReader`接口的`测试替身`实例。此时，这个实例仅为一个空壳，想让其有拥有执行动作还需继续编程。
