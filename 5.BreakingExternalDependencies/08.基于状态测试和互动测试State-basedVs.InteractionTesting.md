# 基于状态测试和互动测试 State-based Vs. Interaction Testing
本篇记录了两种测试的概念及应用情景

### 什么是基于状态测试？
基于状态测试`State-based testing`指，测试断言标准为判断值是否符合期望和判断对象状态是否正确。因为以是对象状态是否改变作为断言标准，所以这种测试方法被称为基于状态测试`State-based testing`。

### 什么是互动测试？
然而，当测试类需要与外部资源沟通时，我们就需要验证这个测试类与外部类的互动行为是否正确。即互动测试`Interaction testing`。互动测试的测试点为判断涉及到调用外部资源方法时，判断方法参数是否传递正确。

如当测试一个订单服务类`OrderService`中的下单方法`PlaceOrder()`时，受测类代码(产品代码)如下:
```c#
    public class OrderService
    {
        private UnknownDbContext _storage;
        
        public OrderService()
        {
            _storage = new UnknownDbContext();    //外部储存资源类未知
        }
        public void PlaceOrder(Order order)
        {
            _storage.Store(order);    //涉及到外部资源_storage的void方法，测试时，判断这个方法参数是否传递正确即可完成互动测试
            ...
        }
    }
```
当我们下单时，下的单需要被储存到一个地方，这个地方可以是数据库，也可能是云端某个仓库，但具体在哪我们并不用关心。我们需要关心的是在测试代码中，当调用`PlaceOrder()`方法时，这个方法是否正确与储存仓库正确互动。所以，我们应该检测我们的测试代码调用存储仓库中的`Store()`方法中的参数是否配置正确。

### 如何使用互动测试？
将在下一篇详细记录。

### 什么时候该使用互动测试？
仅仅在受测类中需要与外部资源沟通的时候使用。因为一旦使用了互动测试，测试类/方法就与代码执行细节产生了耦合关系，即必须分析每一句执行细节才能保证测试代码能够正确验证调用的外部资源方法，如`Store()`方法，中的参数是否传递正确。

当一定要涉及到外部资源时，单元测试的核心原则是尽量专注测试外部资源的行为而不是执行细节。所以，能不用互动测试就尽量避免。

暂时想到这么多，最后更新2018/05/07
